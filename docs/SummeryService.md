# 개요
- 본 서비스는 광남동성당 청소년위원회의 예산서, 결산서, 예산상세내역서, 결산상세내역서를 쉽게 작성할 수 있도록 하는 웹서비스입니다.
- 소속단체는 청년회, 자모회, 초등부 주일학교, 중고등부 주일학교 등 4개 단체가 있습니다.
- 프로젝트 단위로 관리되며, 본 서비스에서 프로젝트는 "행사"라는 이름으로 관리됩니다.
- 한 명의 사용자는 여러 단체에 소속될 수 있습니다.
- 행사(프로젝트)는 하나의 단체에만 종속됩니다.
- 사용자는 가입시 소속단체를 선택할 수 있습니다.
- 입력받는 사용자 정보는 필수정보(이름, 세례명, 전화번호, 이메일주소, 생년월일, 직책)와 비필수 부가정보(주소)입니다.
- 메인헤더메뉴 구성 : 메인페이지, 알림(블로그 방식), 행사
- 로그인하지 않은 사용자는 메인페이지만 볼 수 있습니다.

# 필요기능
## 기본기능
- 행사(프로젝트) 생성 기능
- 예산서, 결산서, 예산상세내역서, 결산상세내역서의 샘플은 docs/_sample_docs 폴더에 있습니다.
- 샘플의 양식으로 인쇄할 수 있도록 A4 인쇄사이즈에 맞춰서 자동생성되어야 합니다.
- 영수증 OCR 인식 기능. 필수 인식 정보(날짜, 상호, 결제금액)와 부가 정보(구입항목 및 금액, 사업자번호, 결제수단 등)

## 관리자 기본기능
- 사용자 관리 (관리자 권한 부여 및 회수, 사용자 목록 보기, 사용자 소속단체 지정(복수지정), 사용자 상세 정보 보기, 사용자 정지/활성, 비밀번호 초기화)
- 단체 목록, 단체 추가/삭제
- 블로그 글 관리

# 기술스텍
## 프론트엔드
- React, VITE
## 백엔드
- NestJS, RESTful API
## DB
- PostgreSQL
## ENVIRONMENT
- Docker
## OCR
- 테서렉트OCR, easyOCR의 파이썬 라이브러리

# 개발환경
- MacOS, Docker

# 페이지 구성
## 메인페이지
- 메인타이틀 "광남동성당 청소년위원회 - 편리한 예결산을 위한 서비스"
- 로그인 버튼
## 알림 (블로그) - 로그인 후 첫페이지
- 글 목록 (작성일, 제목)
## 행사
- 행사(프로젝트) 생성 : 행사명, 행사일시(시작일, 종료일), 행사장소, 복음화계획서상 배정된 예산액
- 행사 목록 : 상세보기(예산서 보기, 결산서 보기), 편집(행사명 수정), 삭제(행사 삭제), 예산서 작성, 결산서 작성 버튼 제공
- 예산서 작성 : 수입 목록 작성 -> 예상지출상세 작성 -> 예산서 자동 완성 (순차적으로 페이지 제공)
- 결산서 작성 : 수입 목록 작성 -> 결산지출상세 작성(영수증 업로드 버튼 클릭시 영수증 페이지) -> 결산지출상세 작성 -> 결산서 자동 완성 (순차적으로 페이지 제공)
- 예산서 보기 : 예산서 보기, 예상지출상세 보기, 예산서 및 예상지출상세 내역서 인쇄
- 결산서 보기 : 결산서 보기, 결산지출상세 보기, 결산서 및 결산지출상세 내역서 인쇄

# 주요 상세 설명
## 영수증 OCR 기능
- 독립적인 컨테이너 서비스로 구성 
- 영수증 업로드(드래그앤드롭, 여러 파일 동시 업로드, 최대 100개)
- 영수증 인식해서 날짜, 상호, 결제금액 자동저장 및 목록보여주기 (목록에 영수증 썸네일과 함께 보여주고, 썸네일 클릭시 영수증 보기 오버레이 팝업 보여줌)
- 영수증 목록 보면서 각 항목 바로 수정하고 저장할 수 있어야 함
- TesseractOCR, easyOCR의 파이썬 라이브러리를 이용하여 1차 처리하고 사용자가 재인식을 요구하면 Google Vision API로 보조한다.
- 머신러닝을 통해 사용할 수록 인식율이 상승되도록 한다.
- 자연어 처리 라이브러리 PyKoSpacing(한글 띄어쓰기), symspellpy(맞춤법 교정) 등을 이용하여 한글 인식율을 높인다.
- OpenCV 라이브러리를 활용하여, 사진에서 영수증부분만 잘라내어, 일정한 가로 사이즈, 적정한 파일사이즈로 리사이징해서 영수증을 저장한다.
- docs/_sample_sourcecode 폴더 안에 다른 AI가 작성해준 샘플 코드가 있어. 참고해

## 영수증 데이터 저장
- 필수정보 : 결제일시, 사업자명(상호), 결제금액
- 부가정보 : 사업자번호, 매장주소, 결제방법, 할인금액, 세금(부가세)
- 품목정보 : 구매상세내역이 존재할때만, 품목, 수량, 금액(소계)
- 나머지 정보는 모두 인식하더라고 저장하지 않음

## 권한관리
- 모든 사용자는 모든 행사에 접근하고 열람할 수 있으나, 자신이 작성한 행사만 수정 권한을 가진다. (관리자는 모두 접근 가능)

## 인쇄기능
- docs/_sample_docs 폴더에 있는 샘플과 같은 형식으로 인쇄
- A4 용지 기준으로 인쇄
- PDF로 인쇄 기능 지원

## 개발시 명명규칙
### 파일명
- 테스트용 파일 : test_파일명 으로 사용
- 영수증인식 관련 파일 : ocr_파일명 으로 사용
- 머신러닝 관련 파일 : ml_파일명 으로 사용
### 함수명, 변수명

## 컨테이너의 구성
- front-end
- back-end
- DB
- OCR
- ML

